&НаКлиенте
Процедура Новый_имя_txt(Команда)
	
 // Получаем значение из поля ввода
    ИсходнаяСтрока = Выберите_себе_имя;      
	
	// Проверяем, содержит ли строка только пробелы
    Если СтрДлина(СокрЛП(ИсходнаяСтрока)) = 0 Тогда
        Если СтрДлина(ИсходнаяСтрока) > 0 Тогда
           Предупреждение("Строка не должна содержать только пробелы.");
           Выберите_себе_имя = "";
        Иначе
            Сообщить("Введите хоть что-то!!!");
        КонецЕсли;
        Возврат;
	КонецЕсли;      
	
	// Проверка на ограничение длины строки
	Если СтрДлина(ИсходнаяСтрока) > 10 Тогда
	    Предупреждение("Строка не должна содержать более 10 символов.");
	    Выберите_себе_имя = "";
	    Возврат; 
	КонецЕсли;
	
    // Определяем наборы символов для проверки
    РусскиеБуквы = "абвгдеёжзийклмнопрстуфхцчшщъыьэюя";
    АнглийскиеБуквы = "abcdefghijklmnopqrstuvwxyz";
    ЗнакиПрепинанияЗакрытые = ".!?";
    ЗнакиПрепинанияОткрытые = ",;:";

    // Проверяем начальные и конечные условия строки
    Если Лев(ИсходнаяСтрока, 1) = " " Или Прав(ИсходнаяСтрока, 1) = " " Тогда
        Предупреждение("Строка не должна начинаться или заканчиваться пробелом.");
        Выберите_себе_имя = "";
        Возврат;     
    КонецЕсли;
	
 	// Проверяем наличие знаков препинания в начале строчки
    Если Найти(ЗнакиПрепинанияЗакрытые + ЗнакиПрепинанияОткрытые, НРег(Сред(ИсходнаяСтрока, 1, 1))) > 0 Тогда
        Предупреждение("Первый символ не должен быть знаком препинания.");
        Выберите_себе_имя = "";
        Возврат;  
    КонецЕсли;

    // Флаги для отслеживания состояния строки
    НайденаРусскаяБуква = Ложь;
    НайденаАнглийскаяБуква = Ложь;
    ПредыдущийСимволБылПробелом = Ложь;
    ЗнакПрепинанияНайден = Ложь;
    ТипЗнакаПрепинания = "";       
	ЗнакПрепинанияЗакрытыйВКонце = Ложь;
    ПослеПробелаСимвол = Ложь;     
	ЗнакПрепинанияЗакрытыйНайден = Ложь;    	

    // Перебираем каждый символ в строке
	Для i = 1 По СтрДлина(ИсходнаяСтрока) Цикл    
		
		// Приводим символ к нижнему регистру
        Символ = НРег(Сред(ИсходнаяСтрока, i, 1));

	  	// Обработка логики для открытых знаков препинания
	    Если Найти(ЗнакиПрепинанияОткрытые, Символ) > 0 Тогда
	        Если i = СтрДлина(ИсходнаяСтрока) Или (Сред(ИсходнаяСтрока, i + 1, 1) <> " ") Тогда
	            Предупреждение("После открытого знака препинания должен следовать пробел.");
	            Выберите_себе_имя = "";
	            Возврат;  
	        КонецЕсли;
	        Продолжить;
	    КонецЕсли;

	    // Обработка логики для закрытых знаков препинания
	    Если Найти(ЗнакиПрепинанияЗакрытые, Символ) > 0 Тогда
	        Если ЗнакПрепинанияЗакрытыйНайден Тогда
	            Предупреждение("После закрытого знака препинания нельзя ставить другой закрытый знак препинания, символ или пробел.");
	            Выберите_себе_имя = "";
	            Возврат; 
	        КонецЕсли;
			
		    // Обработка логики для закрытых знаков препинания
	        Если i > 1 И Сред(ИсходнаяСтрока, i - 1, 1) = " " Тогда
	            Предупреждение("Перед закрытым знаком препинания не должен быть пробел.");
	            Выберите_себе_имя = "";
	            Возврат;   
	        КонецЕсли;

	        ЗнакПрепинанияЗакрытыйНайден = Истина;
	        Продолжить;
	    Иначе
	        Если ЗнакПрепинанияЗакрытыйНайден Тогда
	            Предупреждение("После закрытого знака препинания нельзя ставить другой закрытый знак препинания, символ или пробел.");
	            Выберите_себе_имя = "";
	            Возврат;  
	        КонецЕсли;
		КонецЕсли;	    
		
        // Проверяем, принадлежит ли символ к русским или английским буквам
        Если Найти(РусскиеБуквы, Символ) > 0 Тогда
            НайденаРусскаяБуква = Истина;
        ИначеЕсли Найти(АнглийскиеБуквы, Символ) > 0 Тогда
            НайденаАнглийскаяБуква = Истина;
        КонецЕсли;

        // Проверяем на недопустимое сочетание русских и английских букв
        Если НайденаРусскаяБуква И НайденаАнглийскаяБуква Тогда
            Выберите_себе_имя = "";  
            Предупреждение("Недопустимое сочетание русских и английских букв.");
            Возврат;
        КонецЕсли;

        // Проверяем на наличие нескольких пробелов подряд
        Если Символ = " " Тогда
            Если ПредыдущийСимволБылПробелом Или (ЗнакПрепинанияНайден И ТипЗнакаПрепинания = "Закрытый") Тогда
                Выберите_себе_имя = "";
                Предупреждение("Недопустимо использование нескольких пробелов подряд или пробела после закрытого знака препинания.");
                Возврат; 
            КонецЕсли;
            ПредыдущийСимволБылПробелом = Истина;
            Если ТипЗнакаПрепинания = "Открытый" Тогда
                ПослеПробелаСимвол = Ложь;
            КонецЕсли;
        Иначе
            ПредыдущийСимволБылПробелом = Ложь;
            Если ТипЗнакаПрепинания = "Открытый" Тогда
                ПослеПробелаСимвол = Истина;
            КонецЕсли;
        КонецЕсли;

        // Проверяем на наличие недопустимых символов
        Если (Найти(РусскиеБуквы, Символ) = 0) И (Найти(АнглийскиеБуквы, Символ) = 0) И (Символ <> " ") Тогда
            Если Не ЗнакПрепинанияНайден Тогда
                Выберите_себе_имя = "";
                Предупреждение("Недопустимый символ.");
                Возврат;       
            КонецЕсли;
        КонецЕсли;
	КонецЦикла;	
	
	Сообщить("Ваше имя может быть изменено!");
	
КонецПроцедуры

&НаКлиенте
Процедура Новый_имя_xml(Команда)
	// Получаем значение из поля ввода
    ИсходнаяСтрока = Выберите_себе_имя;      
	
	// Проверяем, содержит ли строка только пробелы
    Если СтрДлина(СокрЛП(ИсходнаяСтрока)) = 0 Тогда
        Если СтрДлина(ИсходнаяСтрока) > 0 Тогда
           Предупреждение("Строка не должна содержать только пробелы.");
           Выберите_себе_имя = "";
        Иначе
            Сообщить("Введите хоть что-то!!!");
        КонецЕсли;
        Возврат;
	КонецЕсли;      
	
	// Проверка на ограничение длины строки
	Если СтрДлина(ИсходнаяСтрока) > 10 Тогда
	    Предупреждение("Строка не должна содержать более 10 символов.");
	    Выберите_себе_имя = "";
	    Возврат; 
	КонецЕсли;
	
    // Определяем наборы символов для проверки
    РусскиеБуквы = "абвгдеёжзийклмнопрстуфхцчшщъыьэюя";
    АнглийскиеБуквы = "abcdefghijklmnopqrstuvwxyz";
    ЗнакиПрепинанияЗакрытые = ".!?";
    ЗнакиПрепинанияОткрытые = ",;:";

    // Проверяем начальные и конечные условия строки
    Если Лев(ИсходнаяСтрока, 1) = " " Или Прав(ИсходнаяСтрока, 1) = " " Тогда
        Предупреждение("Строка не должна начинаться или заканчиваться пробелом.");
        Выберите_себе_имя = "";
        Возврат;     
    КонецЕсли;
	
 	// Проверяем наличие знаков препинания в начале строчки
    Если Найти(ЗнакиПрепинанияЗакрытые + ЗнакиПрепинанияОткрытые, НРег(Сред(ИсходнаяСтрока, 1, 1))) > 0 Тогда
        Предупреждение("Первый символ не должен быть знаком препинания.");
        Выберите_себе_имя = "";
        Возврат;  
    КонецЕсли;

    // Флаги для отслеживания состояния строки
    НайденаРусскаяБуква = Ложь;
    НайденаАнглийскаяБуква = Ложь;
    ПредыдущийСимволБылПробелом = Ложь;
    ЗнакПрепинанияНайден = Ложь;
    ТипЗнакаПрепинания = "";       
	ЗнакПрепинанияЗакрытыйВКонце = Ложь;
    ПослеПробелаСимвол = Ложь;     
	ЗнакПрепинанияЗакрытыйНайден = Ложь;    	

    // Перебираем каждый символ в строке
	Для i = 1 По СтрДлина(ИсходнаяСтрока) Цикл    
		
		// Приводим символ к нижнему регистру
        Символ = НРег(Сред(ИсходнаяСтрока, i, 1));

	  	// Обработка логики для открытых знаков препинания
	    Если Найти(ЗнакиПрепинанияОткрытые, Символ) > 0 Тогда
	        Если i = СтрДлина(ИсходнаяСтрока) Или (Сред(ИсходнаяСтрока, i + 1, 1) <> " ") Тогда
	            Предупреждение("После открытого знака препинания должен следовать пробел.");
	            Выберите_себе_имя = "";
	            Возврат;  
	        КонецЕсли;
	        Продолжить;
	    КонецЕсли;

	    // Обработка логики для закрытых знаков препинания
	    Если Найти(ЗнакиПрепинанияЗакрытые, Символ) > 0 Тогда
	        Если ЗнакПрепинанияЗакрытыйНайден Тогда
	            Предупреждение("После закрытого знака препинания нельзя ставить другой закрытый знак препинания, символ или пробел.");
	            Выберите_себе_имя = "";
	            Возврат; 
	        КонецЕсли;
			
		    // Обработка логики для закрытых знаков препинания
	        Если i > 1 И Сред(ИсходнаяСтрока, i - 1, 1) = " " Тогда
	            Предупреждение("Перед закрытым знаком препинания не должен быть пробел.");
	            Выберите_себе_имя = "";
	            Возврат;   
	        КонецЕсли;

	        ЗнакПрепинанияЗакрытыйНайден = Истина;
	        Продолжить;
	    Иначе
	        Если ЗнакПрепинанияЗакрытыйНайден Тогда
	            Предупреждение("После закрытого знака препинания нельзя ставить другой закрытый знак препинания, символ или пробел.");
	            Выберите_себе_имя = "";
	            Возврат;  
	        КонецЕсли;
		КонецЕсли;	    
		
        // Проверяем, принадлежит ли символ к русским или английским буквам
        Если Найти(РусскиеБуквы, Символ) > 0 Тогда
            НайденаРусскаяБуква = Истина;
        ИначеЕсли Найти(АнглийскиеБуквы, Символ) > 0 Тогда
            НайденаАнглийскаяБуква = Истина;
        КонецЕсли;

        // Проверяем на недопустимое сочетание русских и английских букв
        Если НайденаРусскаяБуква И НайденаАнглийскаяБуква Тогда
            Выберите_себе_имя = "";  
            Предупреждение("Недопустимое сочетание русских и английских букв.");
            Возврат;
        КонецЕсли;

        // Проверяем на наличие нескольких пробелов подряд
        Если Символ = " " Тогда
            Если ПредыдущийСимволБылПробелом Или (ЗнакПрепинанияНайден И ТипЗнакаПрепинания = "Закрытый") Тогда
                Выберите_себе_имя = "";
                Предупреждение("Недопустимо использование нескольких пробелов подряд или пробела после закрытого знака препинания.");
                Возврат; 
            КонецЕсли;
            ПредыдущийСимволБылПробелом = Истина;
            Если ТипЗнакаПрепинания = "Открытый" Тогда
                ПослеПробелаСимвол = Ложь;
            КонецЕсли;
        Иначе
            ПредыдущийСимволБылПробелом = Ложь;
            Если ТипЗнакаПрепинания = "Открытый" Тогда
                ПослеПробелаСимвол = Истина;
            КонецЕсли;
        КонецЕсли;

        // Проверяем на наличие недопустимых символов
        Если (Найти(РусскиеБуквы, Символ) = 0) И (Найти(АнглийскиеБуквы, Символ) = 0) И (Символ <> " ") Тогда
            Если Не ЗнакПрепинанияНайден Тогда
                Выберите_себе_имя = "";
                Предупреждение("Недопустимый символ.");
                Возврат;       
            КонецЕсли;
        КонецЕсли;
	КонецЦикла;	
	
	Сообщить("Ваше имя может быть изменено!");

КонецПроцедуры

&НаКлиенте
Процедура Новый_имя_xlsx(Команда)
	// Получаем значение из поля ввода
    ИсходнаяСтрока = Выберите_себе_имя;      
	
	// Проверяем, содержит ли строка только пробелы
    Если СтрДлина(СокрЛП(ИсходнаяСтрока)) = 0 Тогда
        Если СтрДлина(ИсходнаяСтрока) > 0 Тогда
           Предупреждение("Строка не должна содержать только пробелы.");
           Выберите_себе_имя = "";
        Иначе
            Сообщить("Введите хоть что-то!!!");
        КонецЕсли;
        Возврат;
	КонецЕсли;      
	
	// Проверка на ограничение длины строки
	Если СтрДлина(ИсходнаяСтрока) > 10 Тогда
	    Предупреждение("Строка не должна содержать более 10 символов.");
	    Выберите_себе_имя = "";
	    Возврат; 
	КонецЕсли;
	
    // Определяем наборы символов для проверки
    РусскиеБуквы = "абвгдеёжзийклмнопрстуфхцчшщъыьэюя";
    АнглийскиеБуквы = "abcdefghijklmnopqrstuvwxyz";
    ЗнакиПрепинанияЗакрытые = ".!?";
    ЗнакиПрепинанияОткрытые = ",;:";

    // Проверяем начальные и конечные условия строки
    Если Лев(ИсходнаяСтрока, 1) = " " Или Прав(ИсходнаяСтрока, 1) = " " Тогда
        Предупреждение("Строка не должна начинаться или заканчиваться пробелом.");
        Выберите_себе_имя = "";
        Возврат;     
    КонецЕсли;
	
 	// Проверяем наличие знаков препинания в начале строчки
    Если Найти(ЗнакиПрепинанияЗакрытые + ЗнакиПрепинанияОткрытые, НРег(Сред(ИсходнаяСтрока, 1, 1))) > 0 Тогда
        Предупреждение("Первый символ не должен быть знаком препинания.");
        Выберите_себе_имя = "";
        Возврат;  
    КонецЕсли;

    // Флаги для отслеживания состояния строки
    НайденаРусскаяБуква = Ложь;
    НайденаАнглийскаяБуква = Ложь;
    ПредыдущийСимволБылПробелом = Ложь;
    ЗнакПрепинанияНайден = Ложь;
    ТипЗнакаПрепинания = "";       
	ЗнакПрепинанияЗакрытыйВКонце = Ложь;
    ПослеПробелаСимвол = Ложь;     
	ЗнакПрепинанияЗакрытыйНайден = Ложь;    	

    // Перебираем каждый символ в строке
	Для i = 1 По СтрДлина(ИсходнаяСтрока) Цикл    
		
		// Приводим символ к нижнему регистру
        Символ = НРег(Сред(ИсходнаяСтрока, i, 1));

	  	// Обработка логики для открытых знаков препинания
	    Если Найти(ЗнакиПрепинанияОткрытые, Символ) > 0 Тогда
	        Если i = СтрДлина(ИсходнаяСтрока) Или (Сред(ИсходнаяСтрока, i + 1, 1) <> " ") Тогда
	            Предупреждение("После открытого знака препинания должен следовать пробел.");
	            Выберите_себе_имя = "";
	            Возврат;  
	        КонецЕсли;
	        Продолжить;
	    КонецЕсли;

	    // Обработка логики для закрытых знаков препинания
	    Если Найти(ЗнакиПрепинанияЗакрытые, Символ) > 0 Тогда
	        Если ЗнакПрепинанияЗакрытыйНайден Тогда
	            Предупреждение("После закрытого знака препинания нельзя ставить другой закрытый знак препинания, символ или пробел.");
	            Выберите_себе_имя = "";
	            Возврат; 
	        КонецЕсли;
			
		    // Обработка логики для закрытых знаков препинания
	        Если i > 1 И Сред(ИсходнаяСтрока, i - 1, 1) = " " Тогда
	            Предупреждение("Перед закрытым знаком препинания не должен быть пробел.");
	            Выберите_себе_имя = "";
	            Возврат;   
	        КонецЕсли;

	        ЗнакПрепинанияЗакрытыйНайден = Истина;
	        Продолжить;
	    Иначе
	        Если ЗнакПрепинанияЗакрытыйНайден Тогда
	            Предупреждение("После закрытого знака препинания нельзя ставить другой закрытый знак препинания, символ или пробел.");
	            Выберите_себе_имя = "";
	            Возврат;  
	        КонецЕсли;
		КонецЕсли;	    
		
        // Проверяем, принадлежит ли символ к русским или английским буквам
        Если Найти(РусскиеБуквы, Символ) > 0 Тогда
            НайденаРусскаяБуква = Истина;
        ИначеЕсли Найти(АнглийскиеБуквы, Символ) > 0 Тогда
            НайденаАнглийскаяБуква = Истина;
        КонецЕсли;

        // Проверяем на недопустимое сочетание русских и английских букв
        Если НайденаРусскаяБуква И НайденаАнглийскаяБуква Тогда
            Выберите_себе_имя = "";  
            Предупреждение("Недопустимое сочетание русских и английских букв.");
            Возврат;
        КонецЕсли;

        // Проверяем на наличие нескольких пробелов подряд
        Если Символ = " " Тогда
            Если ПредыдущийСимволБылПробелом Или (ЗнакПрепинанияНайден И ТипЗнакаПрепинания = "Закрытый") Тогда
                Выберите_себе_имя = "";
                Предупреждение("Недопустимо использование нескольких пробелов подряд или пробела после закрытого знака препинания.");
                Возврат; 
            КонецЕсли;
            ПредыдущийСимволБылПробелом = Истина;
            Если ТипЗнакаПрепинания = "Открытый" Тогда
                ПослеПробелаСимвол = Ложь;
            КонецЕсли;
        Иначе
            ПредыдущийСимволБылПробелом = Ложь;
            Если ТипЗнакаПрепинания = "Открытый" Тогда
                ПослеПробелаСимвол = Истина;
            КонецЕсли;
        КонецЕсли;

        // Проверяем на наличие недопустимых символов
        Если (Найти(РусскиеБуквы, Символ) = 0) И (Найти(АнглийскиеБуквы, Символ) = 0) И (Символ <> " ") Тогда
            Если Не ЗнакПрепинанияНайден Тогда
                Выберите_себе_имя = "";
                Предупреждение("Недопустимый символ.");
                Возврат;       
            КонецЕсли;
        КонецЕсли;
	КонецЦикла;	
	
	Сообщить("Ваше имя может быть изменено!");

КонецПроцедуры
