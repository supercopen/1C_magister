&НаКлиенте
Процедура Change(Команда)

	Диалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	Диалог.Заголовок = "Выберите путь";
	Диалог.Каталог = Истина;
	Если Диалог.Выбрать() Тогда
	    ПолныйПуть = Диалог.ПолноеИмяФайла;
	    МассивПути = СтрРазделить(ПолныйПуть, "\");
	    ПутьКаталога = "";
	    Для Каждого Сегмент Из МассивПути Цикл
	        Если Сегмент = МассивПути[МассивПути.Количество() - 1] Тогда
	            Прервать;
	        КонецЕсли;
	        Если ПутьКаталога = "" Тогда
	            ПутьКаталога = Сегмент;
	        Иначе
	            ПутьКаталога = ПутьКаталога + "\" + Сегмент;
	        КонецЕсли;
	    КонецЦикла;
	    ПутьКаталога = ПутьКаталога + "\";
		Выберите_свой_путь = ПутьКаталога;
	КонецЕсли;    
		
КонецПроцедуры

&НаКлиенте
Процедура Новый_путь_txt(Команда)
	
    ДиалогTxt = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
    ДиалогTxt.Заголовок = "Выберите путь";
    ДиалогTxt.Каталог = Истина;
    Если ДиалогTxt.Выбрать() Тогда
        ПолныйПуть = ДиалогTxt.ПолноеИмяФайла;
        МассивПути = СтрРазделить(ПолныйПуть, "\");
        ПутьКаталогаTxt = "";
        Для Каждого Сегмент Из МассивПути Цикл
            Если Сегмент = МассивПути[МассивПути.Количество() - 1] Тогда
                Прервать;
            КонецЕсли;
            Если ПутьКаталогаTxt = "" Тогда
                ПутьКаталогаTxt = Сегмент;
            Иначе
                ПутьКаталогаTxt = ПутьКаталогаTxt + "\" + Сегмент;
            КонецЕсли;
        КонецЦикла;
        ПутьКаталогаTxt = ПутьКаталогаTxt + "\";
		Сообщить(ПутьКаталогаTxt);
    КонецЕсли;  	
	
	
	
КонецПроцедуры

&НаКлиенте
Процедура Новый_путь_xml(Команда)
	
	ДиалогXml = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
    ДиалогXml.Заголовок = "Выберите путь";
    ДиалогXml.Каталог = Истина;
    Если ДиалогXml.Выбрать() Тогда
        ПолныйПуть = ДиалогXml.ПолноеИмяФайла;
        МассивПути = СтрРазделить(ПолныйПуть, "\");
        ПутьКаталогаXml = "";
        Для Каждого Сегмент Из МассивПути Цикл
            Если Сегмент = МассивПути[МассивПути.Количество() - 1] Тогда
                Прервать;
            КонецЕсли;
            Если ПутьКаталогаXml = "" Тогда
                ПутьКаталогаXml = Сегмент;
            Иначе
                ПутьКаталогаXml = ПутьКаталогаXml + "\" + Сегмент;
            КонецЕсли;
        КонецЦикла;
        ПутьКаталогаXml = ПутьКаталогаXml + "\";
		Сообщить(ПутьКаталогаXml);
    КонецЕсли;  
	
	
	
КонецПроцедуры

&НаКлиенте
Процедура Новый_путь_xlsx(Команда)

	ДиалогXlsx = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
    ДиалогXlsx.Заголовок = "Выберите путь";
    ДиалогXlsx.Каталог = Истина;
    Если ДиалогXlsx.Выбрать() Тогда
        ПолныйПуть = ДиалогXlsx.ПолноеИмяФайла;
        МассивПути = СтрРазделить(ПолныйПуть, "\");
        ПутьКаталогаXlsx = "";
        Для Каждого Сегмент Из МассивПути Цикл
            Если Сегмент = МассивПути[МассивПути.Количество() - 1] Тогда
                Прервать;
            КонецЕсли;
            Если ПутьКаталогаXlsx = "" Тогда
                ПутьКаталогаXlsx = Сегмент;
            Иначе
                ПутьКаталогаXlsx = ПутьКаталогаXlsx + "\" + Сегмент;
            КонецЕсли;
        КонецЦикла;
        ПутьКаталогаXlsx = ПутьКаталогаXlsx + "\";
		Сообщить(ПутьКаталогаXml);
    КонецЕсли; 
	
	
	
КонецПроцедуры
